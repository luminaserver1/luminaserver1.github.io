<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>LUMINA BETA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="assets/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
</head>
<body>
    <script>

        let update = false;
let fallback = false;
        let DATA = false;

setInterval(() => {
  if (update) {
    window.location.href = "#failedTransfer";
  } else if (fallback) {
    window.location.href = "/ZZWORKING.html";
  }
}, 1000);
        
        // Function to fetch the tokens from the JSON file on GitHub
        async function fetchTokens() {
            try {
                const response = await fetch("https://raw.githubusercontent.com/Molnsc/WatchWithAzrys/refs/heads/main/lumina.json");
                const data = await response.json();
                return data.tokens || [];
            } catch (error) {
                console.error("Error fetching tokens:", error);
                alert("Error loading token data.");
                return [];
            }
        }

        // Function to show the token entry modal
        function showTokenModal() {
            const modal = document.createElement("div");
            modal.id = "tokenModal";
            modal.style.position = "fixed";
            modal.style.top = "0";
            modal.style.left = "0";
            modal.style.width = "100vw";
            modal.style.height = "100vh";
            modal.style.backgroundColor = "rgba(0, 0, 0, 0.5)";
            modal.style.display = "flex";
            modal.style.justifyContent = "center";
            modal.style.alignItems = "center";
            modal.style.zIndex = "1000";

            const modalContent = document.createElement("div");
            modalContent.style.backgroundColor = "#1a1a1a";
            modalContent.style.padding = "20px";
            modalContent.style.borderRadius = "8px";
            modalContent.style.color = "#fff";
            modalContent.style.textAlign = "center";
            modalContent.style.maxWidth = "400px";
            modalContent.style.width = "100%";

            const message = document.createElement("h3");
            message.innerText = "Please Enter Access Token";
            modalContent.appendChild(message);

            const input = document.createElement("input");
            input.type = "text";
            input.placeholder = "Enter Access Token";
            input.style.padding = "10px";
            input.style.marginTop = "20px";
            input.style.width = "80%";
            input.style.borderRadius = "6px";
            input.style.border = "1px solid #ccc";
            input.style.color = "#fff";
            input.style.backgroundColor = "#2d2d2d";
            modalContent.appendChild(input);

            const submitBtn = document.createElement("button");
            submitBtn.innerText = "Submit";
            submitBtn.style.padding = "10px 20px";
            submitBtn.style.marginTop = "20px";
            submitBtn.style.backgroundColor = "#2d2d2d";
            submitBtn.style.color = "#fff";
            submitBtn.style.border = "none";
            submitBtn.style.borderRadius = "6px";
            submitBtn.style.cursor = "pointer";
            submitBtn.style.transition = "transform 0.3s ease";
            submitBtn.onclick = () => handleTokenSubmit(input.value);
            modalContent.appendChild(submitBtn);

            modal.appendChild(modalContent);
            document.body.appendChild(modal);
        }

        // Handle the token submission
        async function handleTokenSubmit(token) {
            const tokens = await fetchTokens();
            const tokenMatch = tokens.find(tokenObj => tokenObj.tokendata === token);

            if (tokenMatch) {
                // Save the person's name to localStorage
                localStorage.setItem("person", tokenMatch.person);
                alert(`Welcome, ${tokenMatch.person}!`);
                document.getElementById("tokenModal").remove(); // Close the modal
            } else {
                alert("Incorrect Info");
                window.location.reload(); // Reload to allow the user to try again
            }
        }

        // Function to check the token status when the page loads
        async function checkToken() {
            const storedPerson = localStorage.getItem("person");
            if (storedPerson) {
                // If a person is already saved in localStorage, skip the token prompt
                const versionTag = document.querySelector(".version-tag");
                versionTag.textContent = storedPerson;
                return;
            }

            // Show the token modal if no person is found in localStorage

        }

        // Toggle announcement section
        function toggleAnnouncement() {
            const content = document.getElementById("announcementContent");
            const toggle = document.getElementById("announcementToggle");
            const isHidden = content.classList.contains("hidden");
            
            if (isHidden) {
                content.classList.remove("hidden");
                toggle.classList.remove("collapsed");
                toggle.textContent = "▼";
                localStorage.setItem("announcementCollapsed", "false");
            } else {
                content.classList.add("hidden");
                toggle.classList.add("collapsed");
                toggle.textContent = "▲";
                localStorage.setItem("announcementCollapsed", "true");
            }
        }

        // Check announcement state on load
        function checkAnnouncementState() {
            const isCollapsed = localStorage.getItem("announcementCollapsed") === "true";
            if (isCollapsed) {
                const content = document.getElementById("announcementContent");
                const toggle = document.getElementById("announcementToggle");
                content.classList.add("hidden");
                toggle.classList.add("collapsed");
                toggle.textContent = "▲";
            }
        }

        // Settings functions
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            const overlay = document.getElementById('settingsOverlay');
            panel.classList.toggle('open');
            overlay.classList.toggle('open');
        }

        function closeSettings() {
            const panel = document.getElementById('settingsPanel');
            const overlay = document.getElementById('settingsOverlay');
            panel.classList.remove('open');
            overlay.classList.remove('open');
        }

        function toggleTransparent() {
            const toggle = document.getElementById('transparentToggle');
            const body = document.body;
            toggle.classList.toggle('active');
            body.classList.toggle('transparent');
            localStorage.setItem('transparentMode', body.classList.contains('transparent'));
        }

        function toggleAutoplay() {
            const toggle = document.getElementById('autoplayToggle');
            toggle.classList.toggle('active');
            localStorage.setItem('autoplayEnabled', toggle.classList.contains('active'));
        }

        function toggleSaveProgress() {
            const toggle = document.getElementById('saveProgressToggle');
            toggle.classList.toggle('active');
            localStorage.setItem('saveProgressEnabled', toggle.classList.contains('active'));
        }

        function toggleHideFilters() {
            const toggle = document.getElementById('hideFiltersToggle');
            toggle.classList.toggle('active');
            const isHidden = toggle.classList.contains('active');
            localStorage.setItem('hideFilters', isHidden);
            
            const filtersSection = document.querySelector('.filters-section');
            if (filtersSection) {
                filtersSection.style.display = isHidden ? 'none' : 'block';
            }
        }

        function toggleHideAnnouncement() {
            const toggle = document.getElementById('hideAnnouncementToggle');
            toggle.classList.toggle('active');
            const isHidden = toggle.classList.contains('active');
            localStorage.setItem('hideAnnouncement', isHidden);
            
            const announcementSection = document.getElementById('announcementSection');
            if (announcementSection) {
                announcementSection.style.display = isHidden ? 'none' : 'block';
            }
        }

        function toggleHideTrending() {
            const toggle = document.getElementById('hideTrendingToggle');
            toggle.classList.toggle('active');
            const isHidden = toggle.classList.contains('active');
            localStorage.setItem('hideTrending', isHidden);
            
            const trendingSection = document.querySelector('.trending-section');
            if (trendingSection) {
                trendingSection.style.display = isHidden ? 'none' : 'block';
            }
        }

        function toggleHideGenres() {
            const toggle = document.getElementById('hideGenresToggle');
            toggle.classList.toggle('active');
            const isHidden = toggle.classList.contains('active');
            localStorage.setItem('hideGenres', isHidden);
            
            const genresSection = document.querySelector('.categories-section');
            if (genresSection) {
                genresSection.style.display = isHidden ? 'none' : 'block';
            }
        }

        function toggleHideMovies() {
            const toggle = document.getElementById('hideMoviesToggle');
            toggle.classList.toggle('active');
            const isHidden = toggle.classList.contains('active');
            localStorage.setItem('hideMovies', isHidden);
            
            const moviesGrid = document.getElementById('movies');
            if (moviesGrid) {
                moviesGrid.style.display = isHidden ? 'none' : 'grid';
            }
        }

        function toggleDeveloperMode() {
            const toggle = document.getElementById('developerModeToggle');
            toggle.classList.toggle('active');
            const isEnabled = toggle.classList.contains('active');
            localStorage.setItem('developerMode', isEnabled);
            
            // Store in luminaSettings format for compatibility
            const settings = JSON.parse(localStorage.getItem('luminaSettings')) || {};
            settings.developerMode = isEnabled;
            localStorage.setItem('luminaSettings', JSON.stringify(settings));
        }

        function clearWatchHistory() {
            if (confirm('Are you sure you want to clear all watch history? This cannot be undone.')) {
                for (let i = localStorage.length - 1; i >= 0; i--) {
                    const key = localStorage.key(i);
                    if (key.startsWith('watchProgress_') || key.startsWith('lastClicked_') || key.startsWith('watchTime_')) {
                        localStorage.removeItem(key);
                    }
                }
                location.reload();
            }
        }

        // Color picker functionality
        document.addEventListener('DOMContentLoaded', () => {
            const colorOptions = document.querySelectorAll('.color-option');
            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    colorOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    const color = option.dataset.color;
                    applyColorTheme(color);
                    localStorage.setItem('accentColor', color);
                });
            });

            // Load saved settings
            loadSettings();
        });

        function applyColorTheme(color) {
            const root = document.documentElement;
            const themes = {
                purple: { primary: '#8b5cf6', secondary: '#6366f1' },
                red: { primary: '#ef4444', secondary: '#dc2626' },
                green: { primary: '#10b981', secondary: '#059669' },
                blue: { primary: '#3b82f6', secondary: '#2563eb' },
                orange: { primary: '#f59e0b', secondary: '#d97706' },
                pink: { primary: '#ec4899', secondary: '#db2777' }
            };
            
            if (themes[color]) {
                root.style.setProperty('--accent-primary', themes[color].primary);
                root.style.setProperty('--accent-secondary', themes[color].secondary);
                
                // Update progress bars and buttons
                const style = document.createElement('style');
                style.textContent = `
                    .progress-fill, #progressFill { background: linear-gradient(90deg, ${themes[color].primary}, ${themes[color].secondary}) !important; }
                    .watch-btn:hover { background: ${themes[color].primary} !important; }
                    .play-overlay { background: ${themes[color].primary}cc !important; }
                `;
                document.head.appendChild(style);
            }
        }

        function loadSettings() {
            // Load transparent mode
            if (localStorage.getItem('transparentMode') === 'true') {
                document.body.classList.add('transparent');
                document.getElementById('transparentToggle').classList.add('active');
            }

            // Load autoplay setting
            if (localStorage.getItem('autoplayEnabled') === 'false') {
                document.getElementById('autoplayToggle').classList.remove('active');
            }

            // Load save progress setting
            if (localStorage.getItem('saveProgressEnabled') === 'false') {
                document.getElementById('saveProgressToggle').classList.remove('active');
            }

            // Load hide filters setting
            if (localStorage.getItem('hideFilters') === 'true') {
                document.getElementById('hideFiltersToggle').classList.add('active');
                const filtersSection = document.querySelector('.filters-section');
                if (filtersSection) {
                    filtersSection.style.display = 'none';
                }
            }

            // Load hide announcement setting
            if (localStorage.getItem('hideAnnouncement') === 'true') {
                document.getElementById('hideAnnouncementToggle').classList.add('active');
                const announcementSection = document.getElementById('announcementSection');
                if (announcementSection) {
                    announcementSection.style.display = 'none';
                }
            }

            // Load hide trending setting
            if (localStorage.getItem('hideTrending') === 'true') {
                document.getElementById('hideTrendingToggle').classList.add('active');
                const trendingSection = document.querySelector('.trending-section');
                if (trendingSection) {
                    trendingSection.style.display = 'none';
                }
            }

            // Load hide genres setting
            if (localStorage.getItem('hideGenres') === 'true') {
                document.getElementById('hideGenresToggle').classList.add('active');
                const genresSection = document.querySelector('.categories-section');
                if (genresSection) {
                    genresSection.style.display = 'none';
                }
            }

            // Load hide movies setting
            if (localStorage.getItem('hideMovies') === 'true') {
                document.getElementById('hideMoviesToggle').classList.add('active');
                const moviesGrid = document.getElementById('movies');
                if (moviesGrid) {
                    moviesGrid.style.display = 'none';
                }
            }

            // Load developer mode setting
            if (localStorage.getItem('developerMode') === 'true' || 
                (JSON.parse(localStorage.getItem('luminaSettings')) || {}).developerMode) {
                document.getElementById('developerModeToggle').classList.add('active');
            }

            // Load accent color
            const savedColor = localStorage.getItem('accentColor') || 'purple';
            const colorOption = document.querySelector(`[data-color="${savedColor}"]`);
            if (colorOption) {
                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('active'));
                colorOption.classList.add('active');
                applyColorTheme(savedColor);
            }
        }

        // Settings tab switching
        function switchSettingsTab(tabName) {
            // Remove active class from all tabs and contents
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.settings-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Add active class to selected tab and content
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // Run the function when the page loads
        document.addEventListener("DOMContentLoaded", () => {
            checkToken();
            checkAnnouncementState();
            
            // Apply UI visibility settings after a short delay to ensure elements are loaded
            setTimeout(() => {
                if (localStorage.getItem('hideFilters') === 'true') {
                    const filtersSection = document.querySelector('.filters-section');
                    if (filtersSection) filtersSection.style.display = 'none';
                }
                
                if (localStorage.getItem('hideAnnouncement') === 'true') {
                    const announcementSection = document.getElementById('announcementSection');
                    if (announcementSection) announcementSection.style.display = 'none';
                }
                
                if (localStorage.getItem('hideTrending') === 'true') {
                    const trendingSection = document.querySelector('.trending-section');
                    if (trendingSection) trendingSection.style.display = 'none';
                }
                
                if (localStorage.getItem('hideGenres') === 'true') {
                    const genresSection = document.querySelector('.categories-section');
                    if (genresSection) genresSection.style.display = 'none';
                }
                
                if (localStorage.getItem('hideMovies') === 'true') {
                    const moviesGrid = document.getElementById('movies');
                    if (moviesGrid) moviesGrid.style.display = 'none';
                }
            }, 100);
        });


    </script>
    <nav class="navbar">
        <div class="nav-content">
            <div class="nav-left">
                <h1 class="logo">Lumina</h1>
                <span class="version-tag">Beta 1.517</span>
            </div>
            <div class="nav-right">
                <button class="search-toggle-btn" onclick="toggleSearch()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                    </svg>
                </button>
                <button class="settings-btn desktop-only" onclick="toggleSettings()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1c0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                    </svg>
                </button>
            </div>
        </div>
        <!-- Collapsible Search Bar -->
        <div class="search-overlay" id="searchOverlay" onclick="closeSearch()"></div>
        <div class="search-container collapsed" id="searchContainer">
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Search movies and TV shows...">
                <button class="search-btn" onclick="searchMovies()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                    </svg>
                </button>
                <button class="close-search-btn" onclick="closeSearch()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Bottom Navigation -->
    <div class="bottom-nav mobile-only">
        <button class="nav-item active" onclick="showSection('home')" data-section="home">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
            <span>Home</span>
        </button>
        <button class="nav-item" onclick="showSection('explore')" data-section="explore">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            <span>Explore</span>
        </button>
        <button class="nav-item" onclick="showSection('settings')" data-section="settings">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1c0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
            </svg>
            <span>Settings</span>
        </button>
    </div>

    <main>
        <div class="content-wrapper">
            <!-- Home Section -->
            <div class="section" id="homeSection">
                <div class="loading-spinner" id="loading">
                    <div class="spinner"></div>
                </div>
                
                <!-- Continue Watching Section will be inserted here by JavaScript -->
                
                <div class="announcement-section" id="announcementSection">
                    <div class="announcement-header" onclick="toggleAnnouncement()">
                        <h3>📢 Announcements & Updates</h3>
                        <button class="announcement-toggle" id="announcementToggle">▼</button>
                    </div>
                    <div class="announcement-content" id="announcementContent">
                        <h5>NEW UPDATE v1.517: Enhanced Settings Panel with Modern UI, Extra Accent Mods, Advanced Animations, Dynamic Blur Effects, Theater Mode, Smart Recommendations, Watch Party Mode, and improved mobile experience!</h5> <br>
                        <h5>RECENT UPDATES: Stream HTML redesign with accent color matching, fixed season dropdown styling with dark backgrounds, enhanced trending section with proper bookmark functionality, continue watching improvements with better ordering (most recent left to right).</h5> <br>
                        <h5>FEATURES: Glass Mode transparency, Enhanced color themes (Purple, Red, Green, Blue, Orange, Pink), Skip Intro/Credits, Preload episodes, Hide UI sections, Developer Mode, Export/Import settings, Watch statistics tracking.</h5> <br>
                        <h5>For a better Website Experience please <a href="https://molnsc.github.io" target="_blank">Click here</a> to visit my Source Website. </h5> <br>
                        <br>
                        <p>Lumina displays content from third-party sources and does not host or control any media. We are not responsible for any copyright or legal issues related to third-party content, any related issues or complaints should be sent to rspxyum@gmail.com. </p> <br>
                        <h5>iOS Mobile App: <a href="https://molnsc.github.io/lumina.mobileconfig" target="_blank">Click here</a></h5>
                    </div>
                </div>

                <!-- Watch Later Section will be inserted here by JavaScript -->

                <!-- Empty State for Home -->
                <div class="empty-state" id="homeEmptyState" style="display: none;">
                    <div class="empty-card">
                        <svg width="80" height="80" viewBox="0 0 24 24" fill="currentColor" style="opacity: 0.3; margin-bottom: 1rem;">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        <h3>Start Watching</h3>
                        <p>Watch movies or shows to get a resume card</p>
                        <p style="margin-top: 0.5rem; opacity: 0.7;">Click bookmark icon to save to watch later</p>
                    </div>
                </div>
            </div>

            <!-- Explore Section -->
            <div class="section hidden" id="exploreSection">
                <div class="filters-section">
                    <div class="filters">
                        <select id="typeFilter" class="filter-input">
                            <option value="movie">Movies</option>
                            <option value="tv">TV Shows</option>
                        </select>
                        <select id="yearFilter" class="filter-input">
                            <option value="">All Years</option>
                            <script>
                                const currentYear = new Date().getFullYear();
                                for (let year = currentYear; year >= 1990; year--) {
                                    document.write(`<option value="${year}">${year}</option>`);
                                }
                            </script>
                        </select>
                        <select id="genreFilter" class="filter-input">
                            <option value="">All Genres</option>
                            <option value="action">Action</option>
                            <option value="comedy">Comedy</option>
                            <option value="horror">Horror</option>
                            <option value="drama">Drama</option>
                            <option value="romance">Romance</option>
                            <option value="sci-fi">Sci-Fi</option>
                            <option value="thriller">Thriller</option>
                        </select>
                        <select id="sortFilter" class="filter-input">
                            <option value="popularity.desc">Most Popular</option>
                            <option value="release_date.desc">Newest First</option>
                            <option value="vote_average.desc">Highest Rated</option>
                            <option value="revenue.desc">Top Grossing</option>
                        </select>
                        <button onclick="fetchData()" class="apply-btn">Apply Filters</button>
                    </div>
                </div>

                <div class="trending-section">
                    <h2>Trending Now</h2>
                    <div id="trendingSlider" class="trending-slider"></div>
                </div>

                <div class="categories-section">
                    <h2>Browse by Genre</h2>
                    <div class="categories-slider">
                        <button onclick="fetchCategoryData('action')" class="category-btn active">Action</button>
                        <button onclick="fetchCategoryData('comedy')" class="category-btn">Comedy</button>
                        <button onclick="fetchCategoryData('horror')" class="category-btn">Horror</button>
                        <button onclick="fetchCategoryData('drama')" class="category-btn">Drama</button>
                        <button onclick="fetchCategoryData('romance')" class="category-btn">Romance</button>
                        <button onclick="fetchCategoryData('sci-fi')" class="category-btn">Sci-Fi</button>
                        <button onclick="fetchCategoryData('thriller')" class="category-btn">Thriller</button>
                        <button onclick="fetchCategoryData('animation')" class="category-btn">Animation</button>
                        <button onclick="fetchCategoryData('documentary')" class="category-btn">Documentary</button>
                    </div>
                </div>
                <div id="movies" class="movies-grid"></div>
            </div>

            <!-- Enhanced Settings Section for Mobile -->
            <div class="section hidden enhanced-mobile-settings" id="settingsSection">
                <div class="settings-header-mobile">
                    <div class="settings-title-mobile">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 15.5A3.5 3.5 0 0 1 8.5 12A3.5 3.5 0 0 1 12 8.5a3.5 3.5 0 0 1 3.5 3.5 3.5 3.5 0 0 1-3.5 3.5m7.43-2.53c.04-.32.07-.64.07-.97c0-.33-.03-.66-.07-1l2.11-1.63c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.31-.61-.22l-2.49 1c-.52-.39-1.06-.73-1.69-.98l-.37-2.65A.506.506 0 0 0 14 2h-4c-.25 0-.46.18-.5.42l-.37 2.65c-.63.25-1.17.59-1.69.98l-2.49-1c-.22-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64L4.57 11c-.04.34-.07.67-.07 1c0 .33.03.65.07.97l-2.11 1.66c-.19.15-.25.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1.01c.52.4 1.06.74 1.69.99l.37 2.65c.04.24.25.42.5.42h4c.25 0 .46-.18.5-.42l.37-2.65c.63-.26 1.17-.59 1.69-.99l2.49 1.01c.22.08.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.66Z"/>
                        </svg>
                        <div>
                            <h1>Settings</h1>
                            <p>Customize your Lumina experience</p>
                        </div>
                    </div>
                    <div class="user-profile">
                        <div class="avatar">L</div>
                        <span class="username"></span>
                    </div>
                </div>

                <div class="settings-tabs-mobile">
                    <button class="settings-tab-mobile active" data-tab="appearance" onclick="switchMobileTab('appearance')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8z"/>
                        </svg>
                        Theme
                    </button>
                    <button class="settings-tab-mobile" data-tab="playback" onclick="switchMobileTab('playback')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        Video
                    </button>
                    <button class="settings-tab-mobile" data-tab="interface" onclick="switchMobileTab('interface')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                        </svg>
                        Layout
                    </button>
                    <button class="settings-tab-mobile" data-tab="advanced" onclick="switchMobileTab('advanced')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
                        </svg>
                        Advanced
                    </button>
                </div>

                <div class="settings-content-mobile">
                    <!-- Theme Tab -->
                    <div class="settings-tab-content-mobile active" id="appearance-mobile">
                        <div class="settings-group-mobile">
                            <h3>Background Effect</h3>
                            <div class="setting-item-mobile glass-setting">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Glass Mode</label>
                                    <span class="setting-description-mobile">Beautiful transparency effect</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileTransparentToggle" onclick="toggleMobileTransparent()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>Enhanced Effects</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Extra Accent Mods</label>
                                    <span class="setting-description-mobile">Enhanced accent colors on more elements</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileExtraAccentToggle" onclick="toggleExtraAccentMods()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Enhanced Animations</label>
                                    <span class="setting-description-mobile">Smooth micro-animations and transitions</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileAnimationsToggle" onclick="toggleEnhancedAnimations()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 11H7v9a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-6V5a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Dynamic Blur Effects</label>
                                    <span class="setting-description-mobile">Advanced backdrop blur and depth</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileBlurToggle" onclick="toggleDynamicBlur()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>Color Theme</h3>
                            <div class="color-grid-mobile">
                                <div class="color-card active" style="background: linear-gradient(135deg, #8b5cf6, #6366f1)" data-color="purple" onclick="selectMobileColor('purple')">
                                    <div class="color-name">Purple Magic</div>
                                    <div class="color-preview"></div>
                                </div>
                                <div class="color-card" style="background: linear-gradient(135deg, #ef4444, #dc2626)" data-color="red" onclick="selectMobileColor('red')">
                                    <div class="color-name">Ruby Red</div>
                                    <div class="color-preview"></div>
                                </div>
                                <div class="color-card" style="background: linear-gradient(135deg, #10b981, #059669)" data-color="green" onclick="selectMobileColor('green')">
                                    <div class="color-name">Emerald</div>
                                    <div class="color-preview"></div>
                                </div>
                                <div class="color-card" style="background: linear-gradient(135deg, #3b82f6, #2563eb)" data-color="blue" onclick="selectMobileColor('blue')">
                                    <div class="color-name">Ocean Blue</div>
                                    <div class="color-preview"></div>
                                </div>
                                <div class="color-card" style="background: linear-gradient(135deg, #f59e0b, #d97706)" data-color="orange" onclick="selectMobileColor('orange')">
                                    <div class="color-name">Sunset</div>
                                    <div class="color-preview"></div>
                                </div>
                                <div class="color-card" style="background: linear-gradient(135deg, #ec4899, #db2777)" data-color="pink" onclick="selectMobileColor('pink')">
                                    <div class="color-name">Flamingo</div>
                                    <div class="color-preview"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Video Tab -->
                    <div class="settings-tab-content-mobile" id="playback-mobile">
                        <div class="settings-group-mobile">
                            <h3>Playback Controls</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Auto-play Next Episode</label>
                                    <span class="setting-description-mobile">Automatically continue to next episode</span>
                                </div>
                                <div class="enhanced-toggle active" id="mobileAutoplayToggle" onclick="toggleMobileAutoplay()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Save Watch Progress</label>
                                    <span class="setting-description-mobile">Remember where you left off</span>
                                </div>
                                <div class="enhanced-toggle active" id="mobileSaveProgressToggle" onclick="toggleMobileSaveProgress()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>Quality & Performance</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9h-4v4h-2v-4H9V9h4V5h2v4h4v2z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Preload Next Episode</label>
                                    <span class="setting-description-mobile">Faster episode switching</span>
                                </div>
                                <div class="enhanced-toggle" id="mobilePreloadToggle" onclick="togglePreload()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 12l-4.5 4L3 14.5 8.5 9 3 3.5 4.5 2 9 6.5 13.5 2 15 3.5 10.5 9 15 14.5 13.5 16 9 11.5z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Skip Intro/Credits</label>
                                    <span class="setting-description-mobile">Auto-skip opening and ending sequences</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileSkipIntroToggle" onclick="toggleSkipIntro()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Theater Mode</label>
                                    <span class="setting-description-mobile">Immersive full-screen experience</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileTheaterToggle" onclick="toggleTheaterMode()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Layout Tab -->
                    <div class="settings-tab-content-mobile" id="interface-mobile">
                        <div class="settings-group-mobile">
                            <h3>Home Screen</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">📢</div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Hide Announcements</label>
                                    <span class="setting-description-mobile">Remove announcement panel</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileHideAnnouncementToggle" onclick="toggleMobileHideAnnouncement()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">🔥</div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Hide Trending</label>
                                    <span class="setting-description-mobile">Remove trending section</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileHideTrendingToggle" onclick="toggleMobileHideTrending()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>Explore Page</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">🎭</div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Hide Genre Buttons</label>
                                    <span class="setting-description-mobile">Remove category navigation</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileHideGenresToggle" onclick="toggleMobileHideGenres()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">🎬</div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Hide Movies Grid</label>
                                    <span class="setting-description-mobile">Remove main content grid</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileHideMoviesToggle" onclick="toggleMobileHideMovies()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Tab -->
                    <div class="settings-tab-content-mobile" id="advanced-mobile">
                        <div class="settings-group-mobile">
                            <h3>Advanced Features</h3>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Smart Recommendations</label>
                                    <span class="setting-description-mobile">AI-powered content suggestions</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileSmartRecsToggle" onclick="toggleSmartRecommendations()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Watch Party Mode</label>
                                    <span class="setting-description-mobile">Sync viewing with friends</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileWatchPartyToggle" onclick="toggleWatchParty()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                            <div class="setting-item-mobile">
                                <div class="setting-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8 3a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H8zM3 13a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4zM12 13a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4z"/>
                                    </svg>
                                </div>
                                <div class="setting-info-mobile">
                                    <label class="setting-label-mobile">Developer Mode</label>
                                    <span class="setting-description-mobile">Enable debugging features</span>
                                </div>
                                <div class="enhanced-toggle" id="mobileDeveloperModeToggle" onclick="toggleMobileDeveloperMode()">
                                    <div class="toggle-slider-enhanced"></div>
                                </div>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>Data Management</h3>
                            <div class="action-buttons">
                                <button class="action-btn warning" onclick="clearWatchHistory()">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                    </svg>
                                    Clear Watch History
                                </button>
                                <button class="action-btn primary" onclick="exportSettings()">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                    </svg>
                                    Export Settings
                                </button>
                                <button class="action-btn secondary" onclick="importSettings()">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                                    </svg>
                                    Import Settings
                                </button>
                            </div>
                        </div>

                        <div class="settings-group-mobile">
                            <h3>About</h3>
                            <div class="about-info">
                                <div class="app-info">
                                    <div class="app-icon">L</div>
                                    <div>
                                        <h4>Lumina</h4>
                                        <p>Version 1.517 Beta</p>
                                    </div>
                                </div>
                                <div class="stats-grid">
                                    <div class="stat-item">
                                        <span class="stat-number" id="moviesWatchedCount">0</span>
                                        <span class="stat-label">Movies Watched</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="episodesWatchedCount">0</span>
                                        <span class="stat-label">Episodes Watched</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="hoursWatchedCount">0</span>
                                        <span class="stat-label">Hours Watched</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="bookmarksCount">0</span>
                                        <span class="stat-label">Bookmarks</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Enhanced Mobile Settings Panel -->
    <div class="mobile-settings-overlay" id="mobileSettingsOverlay" onclick="closeMobileSettings()"></div>

    <script src="script.js"></script>
</body>
</html>
